{% extends '@Shares/base.html.twig' %}

{% block head_css %}
    {{ parent() }}
    <style>
        .form-check-input:checked + .form-checked-content {
        opacity: .5;
        }

        .form-check-input-placeholder {
        border-style: dashed;
        }
        [contenteditable]:focus {
        outline: 0;
        }

        .list-group-checkable .list-group-item {
        cursor: pointer;
        }
        .list-group-item-check {
        position: absolute;
        clip: rect(0, 0, 0, 0);
        }
        .list-group-item-check:hover + .list-group-item {
        background-color: var(--bs-secondary-bg);
        }
        .list-group-item-check:checked + .list-group-item {
        color: #fff;
        background-color: var(--bs-primary);
        border-color: var(--bs-primary);
        }
        .list-group-item-check[disabled] + .list-group-item,
        .list-group-item-check:disabled + .list-group-item {
        pointer-events: none;
        filter: none;
        opacity: .5;
        }

        .list-group-radio .list-group-item {
        cursor: pointer;
        border-radius: .5rem;
        }
        .list-group-radio .form-check-input {
        z-index: 2;
        margin-top: -.5em;
        }
        .list-group-radio .list-group-item:hover,
        .list-group-radio .list-group-item:focus {
        background-color: var(--bs-secondary-bg);
        }

        .list-group-radio .form-check-input:checked + .list-group-item {
        background-color: var(--bs-body);
        border-color: var(--bs-primary);
        box-shadow: 0 0 0 2px var(--bs-primary);
        }
        .list-group-radio .form-check-input[disabled] + .list-group-item,
        .list-group-radio .form-check-input:disabled + .list-group-item {
        pointer-events: none;
        filter: none;
        opacity: .5;
        }
    </style>
{% endblock %}

{% block shares_component %}

    <div class="card">
        <div class="card-body d-flex align-items-center justify-content-between">
            <h4 class="mb-0 fw-light">My Wallet Balance</h4>
            <h4 class="mb-0 fw-light ms-2">
                {{ constant('SHARES_CURRENCY') }}{{ (user.getUserMeta("user.balance")|default(0))|number_format(2) }}
            </h4>
        </div>
    </div>

    <div class="mt-3 border-top py-2">

        {% if walletInfo is empty %}

            <div class="text-center fs-md-22px py-2">
                <i class="bi bi-exclamation-triangle me-1 text-danger"></i> 
                Please set up your <a href="{{ DashboardExtension.urlGenerator("/payment") }}">payment info</a> to process withdrawal
            </div>

        {% else %}

            <form method="POST">
                <div class="row">

                    <div class="col-lg-6 mb-3">
                        <div class="card">
                            <div class="card-body">

                                <h5 class="fw-normal border-bottom pb-2">
                                    <i class="bi bi-gem me-1"></i> Please select a withdrawal method
                                </h5>

                                <div class="list-group list-group-checkable d-grid gap-2 border-0">

                                    {% for index, gateway in gateways %}

                                        {% set key = "wallet." ~ gateway.id %}
                                        {% set wallet = walletInfo[key] %}

                                        {% if wallet is not empty %}

                                            <input class="list-group-item-check pe-none" type="radio" name="wallet_index" id="{{ key }}" value="{{ key }}" {{ index == 0 ? 'checked' : null }}>
                                            <label class="list-group-item rounded-3 py-3" for="{{ key }}">
                                                {{ wallet.name }}
                                            </label>

                                        {% endif %}

                                    {% endfor %}

                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-body p-4">

                                <div class="mb-2">
                                    <label class="form-label">Amount</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            {{ constant('SHARES_CURRENCY') }}
                                        </span>
                                        <input type='number' step="0.01" class="form-control" required name="amount">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Password</label>
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-lock"></i>
                                        </span>
                                        <input type='password' class="form-control" required name="password">
                                    </div>
                                </div>

                                <div class="mb-2 text-end">
                                    <button class="btn btn-primary" type="submit">
                                        <i class="bi bi-coin me-1"></i> Withdraw Fund
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </form>

        {% endif %}
    </div>

{% endblock %}